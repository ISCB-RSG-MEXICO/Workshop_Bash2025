# Bed tools - Procesamiento

wget <https://ftp.ensembl.org/pub/release-112/gff3/drosophila_melanogaster/Drosophila_melanogaster.BDGP6.46.112.gff3.gz> zgrep -v '\^#' Drosophila_melanogaster.BDGP6.46.112.gff3.gz \> Dmel_clean.gff3 grep -P '\^(2L\|2R\|3L\|3R\|4\|X\|Y)\t' Dmel_clean.gff3 \> Dmel_main.gff3 grep -P'\^2L\t' Dmel_main.gff3 \> Dmel_2L.gff3 grep -P '\tgene\t' Dmel_2L.gff3 \> Dmel_2L_genes.gff3 awk -F "\t" 'BEGIN{OFS="\t"} { split(\$9,a,";"); print \$1, \$4-1, \$5, a\[1\] }' Dmel_2L_genes.gff3 \> genes_2L.bed

wget <https://ftp.ncbi.nlm.nih.gov/geo/samples/GSM853nnn/GSM853481/suppl/GSM853481_2011-1333_2011-1334.merged_2011-1335_peaks.bed.gz> gunzip GSM853481_2011-1333_2011-1334.merged_2011-1335_peaks.bed.gz grep -P '\^2L\t' GSM853481_2011-1333_2011-1334.merged_2011-1335_peaks.bed \> peaks_2L.bed sort -k1,1 -k2,2n peaks_2L.bed \> peaks_2L.sorted.bed \# instalar bedtools con sudo apt-get install bedtools bedtools intersect -a genes_2L.bed -b peaks_2L.sorted.bed \> genes_peaks_intersect.bed bedtools coverage -a genes_2L.bed -b peaks_2L.sorted.bed \> genes_coverage.tsv
