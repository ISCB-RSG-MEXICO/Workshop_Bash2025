# ðŸ’» IntroducciÃ³n

Este documento proporciona una guÃ­a bÃ¡sica para trabajar con **R**, **Bedtools**, y archivos genÃ³micos. \

Incluye:

-   PreparaciÃ³n del ambiente
-   Comandos esenciales de Bedtools
-   Lectura y manipulaciÃ³n de BED/GFF en R
-   Ejemplos prÃ¡cticos

------------------------------------------------------------------------

# ðŸ”§ Requerimientos

## Software necesario

-   **R** (versiÃ³n 4+)
-   **RStudio** (opcional)
-   **Bedtools** instalado en tu sistema
-   Paquetes R:
    -   `tidyverse`
    -   `rtracklayer`
    -   `data.table`
    -   `GenomicRanges`

``` r
install.packages(c("tidyverse", "data.table"))
BiocManager::install(c("rtracklayer", "GenomicRanges"))
```

------------------------------------------------------------------------

# ðŸ§¬ Â¿QuÃ© es Bedtools?

**Bedtools** es una suite de herramientas para realizar operaciones sobre regiones genÃ³micas.

Permite: - Intersecciones - Complementos - Uniones - Filtrados - Cobertura - ConversiÃ³n entre formatos

------------------------------------------------------------------------

# ðŸ“ Formatos comÃºnes (BED, GFF, FASTA)

## Formato BED

Columnas mÃ­nimas: \
1. cromosoma 2. inicio 3. fin

Ejemplo:

```         
chr1    1000    1500
chr1    2000    2300
```

## Formato GFF/GTF

tiene 9 columnas (atributos mÃ¡s complejos).

------------------------------------------------------------------------

# âœ¨ Comandos bÃ¡sicos de Bedtools

## Intersectar regiones

``` bash
bedtools intersect -a A.bed -b B.bed > interseccion.bed
```

## Unir regiones

``` bash
bedtools merge -i regiones.bed > regiones_unidas.bed
```

## Complemento genÃ³mico

``` bash
bedtools complement -i regiones.bed -g genome_file.txt > complement.bed
```

## Cobertura

``` bash
bedtools coverage -a regiones.bed -b alineamientos.bam > coverage.txt
```

------------------------------------------------------------------------

# ðŸ“¥ Leer archivos BED en R

## Con `rtracklayer`

``` r
library(rtracklayer)
bed <- import("archivo.bed", format = "BED")
bed
```

## Con `data.table`

``` r
library(data.table)
bed <- fread("archivo.bed", header = FALSE)
colnames(bed) <- c("chr", "start", "end")
bed
```

------------------------------------------------------------------------

# ðŸ”— Convertir BED a GRanges

``` r
library(GenomicRanges)
bed_gr <- makeGRangesFromDataFrame(bed, keep.extra.columns = TRUE)
bed_gr
```

------------------------------------------------------------------------

# ðŸ“¤ Exportar BED desde R

``` r
export(bed_gr, "salida.bed", format = "BED")
```

------------------------------------------------------------------------

# ðŸ§ª Ejemplo prÃ¡ctico completo

``` r
library(rtracklayer)
library(GenomicRanges)

# 1. Cargar BED
a <- import("A.bed", format = "BED")
b <- import("B.bed", format = "BED")

# 2. IntersecciÃ³n en R (similar a bedtools intersect)
inter <- subsetByOverlaps(a, b)
inter

# 3. Exportar resultado
export(inter, "intersect_R.bed", format = "BED")
```

------------------------------------------------------------------------

# ðŸ§­ Integrar R + Bedtools desde R

Puedes ejecutar Bedtools dentro de R:

``` r
system("bedtools intersect -a A.bed -b B.bed > inter.bed")
```

------------------------------------------------------------------------

# Referencias 

-   Bedtools manual [https://bedtools.readthedocs.io/](https://bedtools.readthedocs.io/?utm_source=chatgpt.com)
-   Bioconductor: GenomicRanges, rtracklayer <https://bioconductor.org/packages/release/bioc/html/rtracklayer.html>
-   UCSC Genome Browser formatos <https://genome.ucsc.edu/>
