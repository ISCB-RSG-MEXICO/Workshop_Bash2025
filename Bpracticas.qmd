# Buenas pr√°cticas en bioinform√°tica

## ‚≠ê ¬øQu√© es un algoritmo?

Un **algoritmo** es un m√©todo para resolver un problema mediante una serie de pasos **definidos, precisos** y **finitos**.

-   **Definido**: si se sigue dos veces, se obtiene el mismo resultado (Es reproducible).
-   **Preciso**: implica el orden de realizaci√≥n de cada uno de los pasos.
-   **Finito**: Tiene un numero determinado de pasos, implica que tiene un fin.

Un algoritmo podemos definirlo como un **programa o software**.

## üß© ¬øQu√© necesitamos para escribir un buen software?

> Crear software confiable implica aplicar principios de ingenier√≠a:
>
> -   **C√≥digo mantenible (maintainable code)**
>
> -   **Control de versiones** (version control, ej. Git)
>
> -   **Rastreadores de problemas** (issue trackers)
>
> -   **Revisiones de c√≥digo** (code reviews)
>
> -   **Pruebas unitarias** (unit testing)
>
> -   **Automatizaci√≥n de tareas** (task automation)
>
> Basado en [*Wilson, et al. 2014. PLOS Biology*](https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.1001745)

## üîê √âtica y responsabilidad en bioinform√°tica

En bioinform√°tica es crucial garantizar el **uso √©tico y responsable** de datos, especialmente cuando incluyen **genomas humanos** o informaci√≥n sensible.\

Esto implica:

-   Proteger la privacidad del individuo.

-   Respetar las regulaciones y marcos legales vigentes.

-   Mantener pr√°cticas transparentes y reproducibles.

-   Evitar errores que comprometan la integridad del an√°lisis.

Estas medidas fortalecen la confianza en los resultados y evitan problemas graves como **retractaciones cient√≠ficas**.

## üß™ Pasos para escribir un buen software

::: callout-note
1.  An√°lisis del problema / Definir el problema

2.  Dise√±o del algoritmo / Dise√±o del programa

3.  Codificaci√≥n / Escribir el c√≥digo

4.  Compilaci√≥n y ejecuci√≥n del programa

5.  Verificaci√≥n / Realizar pruebas

6.  Depuraci√≥n / Detectar los errores y corregirlos (Programacion defensiva)

7.  Documentaci√≥n
:::

-   ::: callout-note
    ### üóÇÔ∏è Paso 7: Documentaci√≥n

    Incluye siempre:

    -   *T√≠tulo* (opcional)

    -   *Autor (author)*: Su nombre

    -   *Dia (date)*: Fecha de creaci√≥n

    -   *Paquetes (packages)*

    -   *Directorio de trabajo (Working directory)*: En que carpeta se encuentra tu datos y programa.

    -   *Informaci√≥n descriptiva del programa (Description)*: ¬øPara qu√© sirve el programa? Ej: El siguiente programa realiza la suma de dos numeros enteros a partir de la entrada del usuario y posteriormente la imprime en pantalla.

    -   *Usage* ¬øC√≥mo se utiliza?

    -   *Argumentos (Arguments)*

        -   *Informaci√≥n de entrada (Data Inputs)*: Ej: Solo numeros enteros (sin decimales).

        -   *Informaci√≥n de salida (Outpus)*: Graficas, figuras, tablas, etc.
    :::

![](https://eveliacoss.github.io/Buenaspracticas_R_Mayo2024/BestPractices/figures/meme_documentacion.jpg){fig-align="center"}

## ‚≠ê Puntos clave para buenas pr√°cticas en bioinform√°tica

### 
‚úèÔ∏è 1. Escribe programas para personas, no para m√°quinas

-   Documenta **qu√© hace** tu c√≥digo y **por qu√©**.

-   Mant√©n coherencia en nombres, indentaci√≥n y estilo.

### üß± 2. Usa modularidad

-   Divide tu c√≥digo en **funciones peque√±as de un solo prop√≥sito**.

### 
‚û∞ 3. No repitas c√≥digo

-   Crea pasos reproducibles o que se repitan por si solos (Usa funciones, loops y scripts reproducibles).

### 
üö© 4. Planifica los errores (**programaci√≥n defensiva)**

-   ~Es\ una\ pr√°ctica\ donde\ **asumes\ que\ pueden\ ocurrir\ errores**\ y\ **preparas\ tu\ c√≥digo**\ para\ detectarlos,\ avisar\ y\ manejar\ la\ situaci√≥n\ sin\ que\ todo\ truene.\

    No\ se\ trata\ de\ ser\ pesimista:\ es\ ser\ **realista**.~

    ::: {.callout-note style=".callout {   background: #faf4f7;   border-left: 5px solid #d8a1b5; /* rose gold */   padding: 1.1rem 1.3rem;   border-radius: 12px;   color: #8a4f62;   box-shadow: 0px 3px 10px rgba(214, 150, 170, 0.2); }" icon="false"}
    ~bash~

    `#validaci√≥n de un archivo vacio if [ ! -s "$file" ]; then  #Si el archivo no existe o tiene tama√±o 0, entra al thenecho "Error: archivo vac√≠o o no existe" >&2  #imprime el mensaje. y >&2 env√≠a el mensaje al stderr (salida de error)exit 1  #1 es un c√≥digo de error (0 = √©xito, cualquier otro n√∫mero = fallo).fi  #Es el cierre del if`

    `r`

    `if (!file.exists(fasta_path)) { #Si NO existe el archivo fasta   stop("El archivo FASTA no existe: ", fasta_path)  #Detiene completamente la ejecuci√≥n del script.} #cierre del condicional`

    `seqs <- read.fasta(fasta_path)` `# lee el archivo y guarda las secuencias en el objeto seqsif (length(seqs) == 0) {  #length(seqs) == 0 ‚Üí no se carg√≥ ninguna secuencia.stop("El archivo FASTA est√° vac√≠o.") #Se detiene y imprime el mensaje}``#cierre del condicional`
    :::

### 
‚öôÔ∏è 5. Optimiza al final

-   Primero que funcione.

-   Despu√©s que funcione *bien*.

-   Optimiza el software s√≥lo despu√©s de que funcione correctamente. - Si funciona no lo modifiques, simplificalo.

## ü§ñ ¬øC√≥mo te puede ayudar ChatGPT en tus buenas pr√°cticas de bioinform√°tica?

~Aunque\ hoy\ en\ d√≠a\ existe\ cierto\ tab√∫\ alrededor\ del\ uso\ de\ la\ IA\ como\ ChatGPT,\ es\ una\ herramienta\ que\ realmente\ puede\ facilitarnos\ la\ vida.\ No\ reemplaza\ nuestro\ criterio,\ solo\ lo\ complementa.\ ¬°√ösala\ sin\ miedo!\ Puede\ ayudarte\ much√≠simo.\ ‚ú®~

ChatGPT puede ser una herramienta poderosa para mejorar tu flujo de trabajo:

-   **Documentaci√≥n autom√°tica**: genera descripciones, t√≠tulos, secciones y ejemplos para tus scripts.

-   **Explicaci√≥n de c√≥digo**: te ayuda a entender funciones complejas o pipelines bioinform√°ticos.

-   **Optimizaci√≥n responsable**: sugiere mejoras sin comprometer la reproducibilidad.

-   **Buenas pr√°cticas**: te recuerda est√°ndares como estilo, modularidad, defensividad y testing.

-   **Aprendizaje guiado**: explica conceptos (FASTQ, SAM/BAM, ensambladores, alineadores, R, Python).

-   **Depuraci√≥n asistida**: se√±ala errores comunes y propone soluciones.

-   **Reproducibilidad**: ayuda a generar pipelines claros, estructurados y bien documentados.

-   **Plantillas listas para usar**: para README, `.qmd`, scripts, workflows o Snakemake.

> **ChatGPT no reemplaza tu criterio cient√≠fico, pero s√≠ amplifica tu precisi√≥n, claridad y reproducibilidad.**

# ü¶æ Buenas pr√°cticas en **R**

Trabajar en R para bioinform√°tica requiere c√≥digo limpio, reproducible y f√°cil de compartir. Aqu√≠ tienes un conjunto de buenas pr√°cticas recomendadas por expertos y comunidades como *R for Data Science*, *The Tidyverse Style Guide*, *Bioconductor* y *The Carpentries*.

## üìÅ 1. Organiza tus proyectos con *project-based workflows*

-   Usa siempre un **RStudio Project (`.Rproj`)**.

-   Evita rutas absolutas como:\
    `setwd("C:/Users/Mariana/Desktop/")` ‚ùå

-   Usa rutas relativas con **`here::here()`** o **`fs`**:\
    `here("data", "input.csv")` ‚úîÔ∏è

-   Mant√©n carpetas claras:

::: {.callout-note style=".callout {   background: #faf4f7;   border-left: 5px solid #d8a1b5; /* rose gold */   padding: 1.1rem 1.3rem;   border-radius: 12px;   color: #8a4f62;   box-shadow: 0px 3px 10px rgba(214, 150, 170, 0.2); }"}
~bash~

`/data`

`/scripts`

`/results`

`/figures`
:::

## üì¶ 2. Carga solo los paquetes necesarios

-   Evita cargar 10 paquetes si solo usas 1 funci√≥n.

-   Usa **`pacman::p_load()`** o declara expl√≠citamente tus dependencias.

-   Incluye siempre una secci√≥n ‚ÄúPaquetes‚Äù en tus scripts `.R`.

## ‚úèÔ∏è 3. F√≥rmula de oro: *estilo + consistencia*

Sigue gu√≠as como **tidyverse style guide**:

-   Nombres de objetos en snake_case ‚Üí `mi_dataframe`, `hp_colors`.

-   Espacios consistentes despu√©s de comas y operadores.

-   L√≠neas cortas (\< 80 caracteres).

-   Comentarios claros con:

::: {.callout-note style="background-color: #7F0000;     /* rojo intenso */ border-left: 6px solid #FF0000; /* rojo brillante */ color: #FFDFA3;                 /* dorado suave */" icon="false"}
`r`

`# Filtrar solo Ravenclaw df_ravens`

`<- df %>% filter(House == "Ravenclaw")`
:::

## üß± 4. Modulariza tu c√≥digo

-   Divide an√°lisis largos en **funciones** y **scripts separados**.

-   Guarda funciones en `/scripts/functions.R`.

-   Usa `source("scripts/functions.R")` cuando sea necesario.

Esto evita repetir c√≥digo y hace tus an√°lisis m√°s reproducibles.

## 
üîÑ 5. Haz tu c√≥digo *pipeline-friendly*

Prefiere el estilo tidyverse:

::: {.callout-note style="background-color: #FFF200;       border-left: 6px solid #FFD300;   color: \"black\";"}
`r`

`hp_data %>%   count(House) %>%     mutate(percent = n / sum(n))`
:::

En lugar de 10 l√≠neas de transformaciones anidadas ilegibles.

## üß™ 6. Valida tus datos antes de analizarlos

Incluye checks preventivos:

::: {.callout-note style="background-color: #001A4D;       border-left: 6px solid #0047FF;   color: #E6D5B8;"}
r

`stopifnot(is.data.frame(hp_data)) stopifnot(all(c("House") %in% names(hp_data)))`
:::

Esto evita errores sorpresivos al final del an√°lisis.

## üå± 7. Haz que tus gr√°ficos sean reproducibles

Incluye:

-   T√≠tulo

-   Ejes (o expl√≠citamente sin ejes)

-   Paletas documentadas

-   Tama√±os de punto, fuente, etc.

Y **guarda tus figuras con c√≥digo reproducible**, en una carpeta espec√≠fica:

::: {.callout-note style="background-color: #003B1A;       border-left: 6px solid #00A651;   color: #E0FFE8;"}
r

`ggsave("figures/house_plot.png", width = 6, height = 4, dpi = 300)`
:::

## üìö 8. Documenta tus scripts

Al inicio de cada archivo `.R` incluye:

::: {.callout-note style=".callout {   background: #faf4f7;   border-left: 5px solid #d8a1b5; /* rose gold */   padding: 1.1rem 1.3rem;   border-radius: 12px;   color: #8a4f62;   box-shadow: 0px 3px 10px rgba(214, 150, 170, 0.2); }"}
r

`# Title: Distribuci√≥n de casas HP # Author: Mariana Devon # Date: 2025-11-25 # Description: Analiza la proporci√≥n de casas y genera un gr√°fico. # Inputs: hp_data.csv # Outputs: figure/house_pie.png # Packages: tidyverse`
:::

## üß¨ 9. Usa herramientas de an√°lisis reproducible

Para proyectos grandes:

-   **R Markdown** o **Quarto (`.qmd`)**

-   **renv** para versiones de paquetes

-   **targets** o **drake** para pipelines complejos

-   **Bioconductor** para an√°lisis gen√≥micos estandarizados

## üßº 10. Limpia tu entorno (pero no demasiado)

-   Evita usar `rm(list = ls())` a menos que sea estrictamente necesario.

-   Un proyecto bien estructurado no depende del ‚Äúentorno emocionado‚Äù.

## ü§ñ ¬øC√≥mo ChatGPT te ayuda con buenas pr√°cticas en R?

ChatGPT puede mejorar tus an√°lisis en R de forma √©tica y eficiente:

-   **Genera c√≥digo limpio y estilizado** siguiendo gu√≠as tidyverse.

-   **Transforma scripts sucios** en pipelines claros y reproducibles.

-   **Explica errores en R con detalle** (p. ej., `object not found`, `NAs introduced`).

-   **Sugiere paletas, temas de ggplot y estilos visuales**.

-   **Documenta autom√°ticamente tus funciones** con formato `roxygen2`.

-   **Optimiza la l√≥gica** sin sacrificar claridad.

-   **Te genera plantillas listas para `.qmd`, pipelines o workflows**.

-   **Ayuda a detectar malas pr√°cticas** como copiar y pegar c√≥digo o usar rutas absolutas.

> En pocas palabras: **ChatGPT act√∫a como asistente, auditor de estilo, tutor de R y copiloto de bioinform√°tica**, pero siempre con criterio cient√≠fico tuyo üíõ.

::: callout-note
## Ejemplo de como Evelia Coss realiza sus documentos üíú

Aqui les dejamos el script que le da a sus alumnos [VisualizacionDatos.R](https://github.com/EveliaCoss/RNAseq_classFEB2024/blob/main/Practica_Dia3/scripts/VisualizacionDatos.R) del curso de [An√°lisis de datos de RNA-Seq](https://github.com/EveliaCoss/RNAseq_classFEB2024).
:::

## Referencias

-   Wilson, et al. 2014. [Best Practices for Scientific Computing](https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.1001745). PLOS Biology
-   Wickham, H. (2019), The Tidyverse Style Guide.<https://style.tidyverse.org/>
-   RStudio / Posit, R Projects Workflow.<https://docs.posit.co/>
-   Bioconductor Project, Best practices for reproducible genomics workflows.<https://bioconductor.org/>
-   [Unidad 1 Bioinform√°tica e investigaci√≥n reproducible](https://github.com/AliciaMstt/BioinfInvRepro2016-II/blob/master/Unidad1/Unidad1_Bioinf_e_Investigaci%C3%B3n_Reproducible.md)
-   [The five pillars of computational reproducibility: bioinformatics and beyond](https://academic.oup.com/bib/article/24/6/bbad375/7326135)
-   [Investigaci√≥n reproducible y an√°lisis de datos](https://open-science-training-handbook.github.io/Open-Science-Training-Handbook_ES/02OpenScienceBasics/04ReproducibleResearchAndDataAnalysis.html)
-   Haydee tutorial: [Temas Selectos de An√°lisis Num√©rico y Computaci√≥n Cient√≠fica: Computo cient√≠fico para el an√°lisis de datos](https://haydeeperuyero.github.io/Computo_Cientifico/)
-   Alejandra Medina tutorial: [Control de versiones con GitHub y RStudio](https://comunidadbioinfo.github.io/cdsb2023/control-de-versiones-con-github-y-rstudio.html)
-   Wilson, et al. 2014. [Best Practices for Scientific Computing](https://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.1001745). PLOS Biology
-   Evelia Coss - tutorial [Buenas practicas en R](https://github.com/EveliaCoss/Buenaspracticas_R_Mayo2024)
-   Evelia Coss - [Make your CV tutorial](https://github.com/EveliaCoss/Make_yourCV)
-   Markdwn Guide - [Getting Started](https://www.markdownguide.org/getting-started/)
-   Allison Horst - [Imagenes](https://allisonhorst.com/allison-horst)
-   [Statistical Computing using R and Python](https://srvanderplas.github.io/stat-computing-r-python/)
-   [Training Materials](https://learning.nceas.ucsb.edu/2024-10-coreR/)
-   [Visual Studio Code](https://damiandeluca.com.ar/como-comenzar-con-visual-studio-code-una-guia-para-principiantes)
-   [Articulo reproducibilidad](https://blog.ml.cmu.edu/2020/08/31/5-reproducibility/)
-   Holistic AI Guidelines & Human-Centered AI Practices
